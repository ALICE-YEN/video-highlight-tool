@startuml
title Next.js Whisper API è™•ç†æµç¨‹

actor User
participant "Next.js å‰ç«¯" as FE
participant "Next.js å¾Œç«¯" as BE
participant "FFmpeg (æå–éŸ³è¨Š)" as FFmpeg
participant "OpenAI Whisper API" as Whisper
participant "OpenAI GPT API" as GPT

== å½±ç‰‡ä¸Šå‚³ ==
User -> FE: é¸æ“‡ä¸¦ä¸Šå‚³å½±ç‰‡
FE -> BE: 1ï¸âƒ£ POST /api/extract-audio (é™„å¸¶å½±ç‰‡)

== æå–éŸ³è¨Š ==
BE -> FFmpeg: 2ï¸âƒ£ è½‰æ›å½±ç‰‡ç‚ºéŸ³è¨Š (.wav)
FFmpeg --> BE: 3ï¸âƒ£ è¿”å› .wav æª”æ¡ˆ
BE --> FE: 4ï¸âƒ£ è¿”å› .wav æª”æ¡ˆ

== Whisper API è½‰éŒ„ ==
FE -> BE: 5ï¸âƒ£ POST /api/transcribe (é™„å¸¶ .wav)
BE -> Whisper: 6ï¸âƒ£ è½‰éŒ„éŸ³è¨Š (.wav)ï¼Œè½‰éŒ„çš„æ–‡å­—åŒ…å«æ™‚é–“æˆ³
Whisper --> BE: 7ï¸âƒ£ è¿”å› JSON å­—å¹•

== ä½¿ç”¨ GPT API è§£æå­—å¹• ==
BE -> GPT: 8ï¸âƒ£ è§£æå­—å¹•ï¼Œåˆç†åˆ†æ®µä¸¦ç”¢ç”Ÿæ¨™é¡Œ
GPT --> BE: 9ï¸âƒ£ è¿”å›çµæ§‹åŒ– JSON (å«æ®µè½ & æ¨™é¡Œ)

== è¿”å›çµæœ ==
BE -> FE: ğŸ”Ÿ è¿”å›çµæ§‹åŒ– JSON (å«æ®µè½ & æ¨™é¡Œ)
FE -> User: 1ï¸âƒ£1ï¸âƒ£ é¡¯ç¤ºå­—å¹•æ–¼å½±ç‰‡æ’­æ”¾å™¨


@enduml